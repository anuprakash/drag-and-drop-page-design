<!DOCTYPE html>
<html>
<head>
    <title>...</title>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" />
    <style>
        .table-layout tr td {
            border: 2px dashed #ddd !important;
        }

        .panel table tr td {
            border: 2px dashed #eee !important;
        }

        [contenteditable="true"]:active,
        [contenteditable="true"]:focus {
            padding: 5px 15px;
            font-size: 15px;
            line-height: 1.42857;
            color: #2C3E50;
            background-color: #FFF;
            background-image: none;
            border: 1px solid #DCE4EC;
            border-radius: 4px;
            box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.075) inset;
            transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
        }

        [contenteditable="true"]:hover {
            outline: 2px dashed #0090D2;
        }

        .SizeChooser {
            margin: 5px 10px;
            position: relative;
            text-align: center;
        }

            .SizeChooser table {
                border-collapse: separate;
                border-spacing: 3px;
            }

            .SizeChooser td {
                cursor: pointer;
                border: 1px solid #CCC;
                height: 10px;
                min-width: 10px;
                line-height: 10px;
            }

        .SizeChooser-hover {
            background-color: red;
        }

        .SizeChooser-selected {
            border: 1px #333 solid !important;
        }

        .SizeChooser input {
            width: 30px;
        }
    </style>
</head>
<body class="container">

    <br />
    <br />
    <br />

    <!--<table class="table table-bordered">
        <tr>
            <td rowspan="2">A</td>
            <td>B</td>
        </tr>
        <tr>
            <td>C</td>
        </tr>
    </table>

    <hr style="border-color: red" />

    <table class="table table-bordered">
        <tr>
            <td colspan="5" rowspan="6">A</td>
            <td colspan="4" rowspan="3">B</td>
        </tr>
        <tr></tr>
        <tr></tr>
        <tr>
            <td colspan="4" rowspan="3">C</td>
        </tr>
        <tr></tr>
        <tr></tr>
    </table>

    <hr style="border-color: red" />

    <table class="table table-bordered">
        <tr>
            <td>A</td>
            <td>A</td>
            <td>A</td>
        </tr>
    </table>

    <hr style="border-color: red" />

    <table class="table table-bordered">
        <tr>
            <td>B</td>
            <td>B</td>
            <td>B</td>
            <td>B</td>
        </tr>
    </table>

    <hr style="border-color: red" />

    <table class="table table-bordered">
        <tr>
            <td colspan="5" rowspan="2">A</td>
            <td>C</td>
            <td colspan="2" rowspan="2">A</td>
        </tr>
        <tr>
            <td>C</td>
        </tr>
    </table>-->
    <!--<table class="table table-bordered">
        <tr>
            <th><input type="text" class="form-control customField" /></th>
            <th><input type="text" class="form-control customField" /></th>
            <th><input type="text" class="form-control customField" /></th>
        </tr>
    </table>-->



    <div id="PageLayout">

    </div>

    <!--Kýlavuz panel-->
    <div class="panel hidden">
        <div class="panel-heading">
            <span><i class="fa fa-edit contenteditable" style="cursor: pointer"></i> <span contenteditable="false">Panel primary</span></span>
            <div class="pull-right">
                <!--<a class="btn btn-xs btn-default move-cursor"><i class="fa fa-arrows"></i></a>-->
                <button type="button" class="btn btn-xs btn-default panel-toggle" title='@Html.Localize("btn_toggle")'>
                    <i class="fa fa-caret-down"></i>
                </button>
                <div class="btn-group">
                    <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" title='@Html.Localize("btn_color")'>
                        <i class="fa fa-eye"></i>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li class="bg-gray" data-color="default">
                            <a>&nbsp;</a>
                        </li>
                        <li class="bg-danger" data-color="danger">
                            <a>&nbsp;</a>
                        </li>
                        <li class="bg-success" data-color="success">
                            <a>&nbsp;</a>
                        </li>
                        <li class="bg-info" data-color="info">
                            <a>&nbsp;</a>
                        </li>
                        <li class="bg-warning" data-color="warning">
                            <a>&nbsp;</a>
                        </li>
                        <li class="bg-primary" data-color="primary">
                            <a>&nbsp;</a>
                        </li>
                    </ul>
                </div>
                <div class="btn-group">
                    <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" title='@Html.Localize("btn_color")'>
                        <i class="fa fa-reorder"></i>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li style="height: 222px; width: 222px">
                            <div class="table_size_chooser"><div class="SizeChooser"><table><tbody><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr><tr><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td><td class=""> </td></tr></tbody></table><input><span> x </span><input></div></div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="panel-body">
            <table class="table table-bordered"></table>
        </div>
    </div>
    <!--Kýlavuz panel-->

    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>




    <script>
        var sections = [
            { Id: 1, Name: 'Section-1', RowOrder: 1, Colspan: 1, Rowspan: 1, Color: 'panel-success', RowCount: 1, Fields: [] },
            { Id: 2, Name: 'Section-2', RowOrder: 1, Colspan: 1, Rowspan: 1, Color: 'panel-info', RowCount: 1, Fields: [] },
            {
                Id: 3, Name: 'Section-3', RowOrder: 2, Colspan: 2, Rowspan: 1, Color: 'panel-danger', RowCount: 2,
                Fields: [{ Id: 1, Name: 'isim', RowOrder: 1, Colspan: 1, Rowspan: 1 },
                { FieldId: 2, Name: 'soyisim', RowOrder: 1, Colspan: 1, Rowspan: 1 },
                { FieldId: 3, Name: 'email', RowOrder: 1, Colspan: 1, Rowspan: 1 },
                { FieldId: 4, Name: 'il', RowOrder: 2, Colspan: 2, Rowspan: 1 },
                { FieldId: 5, Name: 'ilçe', RowOrder: 2, Colspan: 1, Rowspan: 1 }]
            }
        ];

        var layout = { Id: 1, RowCount: 2, Sections: sections };


        $(function () {
            var table = $('<table class="table table-bordered table-layout" />');

            for (var i = 0; i < layout.RowCount; i++) {
                var tr = $('<tr/>');

                $.each(layout.Sections, function () {
                    if (this.RowOrder == i + 1) {
                        var panel = $('.panel').clone()
                            .removeClass('hidden')
                            .addClass(this.Color);
                        panel.find('.panel-heading span [contenteditable]').attr('data-name', this.Name).html(this.Name);

                        if (this.Fields.length > 0) {
                            for (var j = 0; j < this.RowCount; j++) {
                                var pTr = $('<tr/>');
                                $.each(this.Fields, function () {
                                    if (this.RowOrder == j + 1) {
                                        var input = $('<input type="text" class="form-control">');
                                        var td = $('<td/>', {
                                            colspan: this.Colspan,
                                            rowspan: this.Rowspan
                                        }).append(input);

                                        pTr.append(td);
                                    }
                                });
                                panel.find('.panel-body table').append(pTr);
                            }
                        }

                        tr.append($('<td/>', {
                            colspan: this.Colspan,
                            rowspan: this.Rowspan
                        }).append(panel));

                    }
                });

                table.append(tr);
            }

            $("#PageLayout").append(table);
        });









        // Panel color setting
        $('body').on('click', '[data-color]', function () {
            var panel = $(this).closest('.panel');
            var color = $(this).data('color');
            panel.removeClass().addClass('panel').addClass('panel-' + color).attr('data-panelcolor', color);
            //eventChangeData();
        });

        // Panel slide toggle effect
        $('body').on('click', '.panel-toggle', function () {
            var panelBlock = $(this).closest('.panel').children('.panel-body');
            panelBlock.slideToggle();
        });

        //contenteditable
        $('body').on('click', '.contenteditable', function () {
            var span = $(this).closest('span');
            var contentEditable = span.children('[contenteditable]');
            contentEditable.attr('contenteditable', true).focus();
            contentEditable.blur(function () {
                $(this).attr('contenteditable', false);
            });
        });
        $('body').on('keydown', '[contenteditable="true"]', function (e) {
            //eventChangeData();
            var item = $(this);
            if (e.keyCode === 13) {
                item.blur();
                return false;
            }
            if (e.keyCode == 27) {
                item.html(item.data('name'));
                item.blur();
                return false;
            }
        });
    </script>
</body>
</html>